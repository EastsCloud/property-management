
{% extends 'base.html' %}
{% block content %}
<h4>缴费记录</h4>
<form method="post" class="row g-2 mb-3">
  <div class="col-md-3">
    <label class="form-label">业主</label>
    <select name="owner_id" class="form-select">
      {% for o in owners %}<option value="{{ o.id }}">{{ o.name }} ({{ o.unit }})</option>{% endfor %}
    </select>
  </div>
  <div class="col-md-3">
    <label class="form-label">关联账单(可选)</label>
    <select name="invoice_id" class="form-select">
      <option value="">--</option>
      {% for i in invoices %}<option value="{{ i.id }}">#{{ i.id }} {{ i.owner.name }} ¥{{ i.amount }} 到期{{ i.due_date }}</option>{% endfor %}
    </select>
  </div>
  <div class="col-md-2"><label class="form-label">金额</label><input name="amount" class="form-control" required></div>
  <div class="col-md-2"><label class="form-label">方式</label><input name="method" class="form-control" placeholder="线上/线下/现金"></div>
  <div class="col-md-2"><label class="form-label">备注</label><input name="note" class="form-control"></div>
  <div class="col-md-12"><button class="btn btn-primary">记录支付</button></div>
</form>

<table class="table table-striped">
  <thead><tr><th>ID</th><th>时间</th><th>业主</th><th>金额</th><th>方式</th><th>备注</th></tr></thead>
  <tbody>
  {% for p in payments %}
    <tr>
      <td>{{ p.id }}</td>
      <td>{{ p.paid_at.strftime('%Y-%m-%d %H:%M') }}</td>
      <td>{{ p.owner.name }}</td>
      <td>¥{{ '%.2f'|format(p.amount) }}</td>
      <td>{{ p.method }}</td>
      <td>{{ p.note or '-' }}</td>
    </tr>
  {% endfor %}
  </tbody>
</table>
{% endblock %}
