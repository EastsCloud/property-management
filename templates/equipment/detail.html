
{% extends 'base.html' %}
{% block content %}
<h4>设备详情 #{{ eq.id }}</h4>
<form method="post" class="row g-3 mb-4">
  <div class="col-md-4"><label class="form-label">名称</label><input name="name" class="form-control" value="{{ eq.name }}" required></div>
  <div class="col-md-4"><label class="form-label">位置</label><input name="location" class="form-control" value="{{ eq.location }}"></div>
  <div class="col-md-4"><label class="form-label">序列号</label><input name="serial" class="form-control" value="{{ eq.serial }}"></div>
  <div class="col-md-4"><label class="form-label">状态</label>
    <select name="status" class="form-select">
      {% for s in ['正常','维护','停用'] %}
        <option {{ 'selected' if eq.status==s else '' }}>{{ s }}</option>
      {% endfor %}
    </select>
  </div>
  <div class="col-12"><button class="btn btn-primary">保存</button></div>
</form>

<div class="row">
  <div class="col-lg-6">
    <div class="card mb-3">
      <div class="card-header">维护计划</div>
      <ul class="list-group list-group-flush">
        {% for p in plans %}
          <li class="list-group-item">{{ p.frequency }} | 下次：{{ p.next_date or '-' }} | {{ p.notes or '' }}</li>
        {% else %}
          <li class="list-group-item text-muted">暂无</li>
        {% endfor %}
      </ul>
      <div class="card-body">
        <form method="post" action="{{ url_for('plan_new', eid=eq.id) }}" class="row g-2">
          <div class="col-md-4"><input name="frequency" class="form-control" placeholder="每季度"></div>
          <div class="col-md-4"><input type="date" name="next_date" class="form-control"></div>
          <div class="col-md-4"><input name="notes" class="form-control" placeholder="备注"></div>
          <div class="col-12"><button class="btn btn-outline-primary">新增计划</button></div>
        </form>
      </div>
    </div>
  </div>
  <div class="col-lg-6">
    <div class="card mb-3">
      <div class="card-header">相关工单</div>
      <ul class="list-group list-group-flush">
        {% for w in wos %}
          <li class="list-group-item">{{ w.status }} - {{ w.description[:40] }}</li>
        {% else %}
          <li class="list-group-item text-muted">暂无</li>
        {% endfor %}
      </ul>
    </div>
  </div>
</div>
{% endblock %}
